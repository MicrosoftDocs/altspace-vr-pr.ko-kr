---
title: AltspaceVR 모바일 성능 가이드
description: 다양한 Unity 속성을 사용하여 Oculus Quest와 같은 모바일 디바이스에서 세계를 선도하는 방법을 알아봅니다.
ms.date: 04/20/2021
ms.topic: article
keywords: world editor, performance, oculus, quest, unity, textures, lightmaps, stats, profiler, draw calls, altspacevr, uploader
ms.openlocfilehash: d5689e245c10ccb61abdd0aaa2327132d4374bb7e53a2eaec316d991b38378fb
ms.sourcegitcommit: b248ba2a6da7d669b430581fc3a1544413b2e9c1
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/11/2021
ms.locfileid: "119126977"
---
# <a name="altspacevr-mobile-performance-guide"></a>AltspaceVR 모바일 성능 가이드

## <a name="main-points"></a>**주요 사항:**

* Oculus Quest 1 및 2의 **72 FPS가** 대상입니다.
* **정적 일괄 처리를 통해 그리기 호출을 줄이는** 것은 필수이며 **25개 미만의 그리기 호출을** 목표로 합니다.
* 정적 일괄 처리를 권장하기 위해 **개체당 하나의 재질(다중** 재질 개체를 별도의 개체로 분할).
* 대부분의 경우 환경의 **개체를** **'정적'으로** 설정해야 합니다.
* **장면당 하나의 Lightmap,** 전체 장면에 대해 2k 또는 4k 1개, 단위당 ~25텍스셀, 개체당 lightmap 크기 조정을 조정해야 합니다(아래 크기 조정 차트).
* **모바일 품질 셰이더(즉,** 'Mobile/Diffuse' 등)를 사용하고, 작업이 많고 프로브의 경우 그리기 호출을 추가하므로 Unity 표준 셰이더/PBR/리플렉션 프로브/광원 프로브를 사용하지 않습니다.
* 화면에 **100k 미만의 삼각형**
* **폐색 선별은** 폐색 선별을 사용하도록 설정하는 선행 비용이 있지만 화면 다각형을 줄이는 데 도움이 될 수 있으므로 진단 패널을 사용하여 Altspace의 프레임 속도에 미치는 영향을 측정합니다.
* 장면의 모든 **질감에** 대해 **'Android용 재정의'를** 사용하고 **RGB(A) 압축 ASTC 6x6 블록 형식으로** 설정합니다.  Lightmaps가 ASTC 압축을 받지 않도록 Android Build 설정 압축을 기본값으로 둡니다(파일/빌드 설정/Android/질감 압축: '재정의하지 마세요').  위의 작업을 수행하고 개체 간에 자료를 공유하여 Android 의 경우 장면의 unity 패키지를 약 **10-20MB로** 유지하려고 합니다.

일반적인 목표는 디바이스에서 허용되는 프레임 속도에 맞추는 것입니다. Oculus Quest 1 및 2에서는 60-72 FPS 범위가 더 현실적인 대상인 경우가 많지만, 장면을 채울 때 모든 관점에서 72FPS로 장면을 실행하는 것이 가장 좋습니다.

프레임 속도는 사용 중인 디바이스에서 AltspaceVR 내에서 측정할 수 **있습니다(설정/지원/진단 패널/FPS 표시** 아래의 AltspaceVR 앱에서 찾을 수 있습니다).

장면을 더 잘 최적화하는 데 사용할 수 있는 표준 Unity 도구의 런다운입니다.

## <a name="stats-panelframe-debuggerprofiler"></a>**통계 패널/프레임 디버거/프로파일러**

* 이러한 도구는 장면의 성능을 향상시키는 데 가장 좋은 친구입니다.  해당 **값은 장면** 재생 중이 아닌 경우와 다르기 때문에(즉, 장면이 재생되지 않을 때 자동 정적 일괄 처리가 발생하지 않음) 장면에서 편집기에서 재생 중일 때만 참조할 수 있습니다.

* **통계** 패널('통계'의 게임 보기에서 볼 수 있는)은 **저장된 일괄 처리/일괄 처리, SetPass 호출 및 프레임 속도의** 양을 표시합니다.

    * 일괄 처리 – 현재 카메라의 관점에서 볼 수 있는 현재 그리기 호출의 양입니다.  환경에 대해 **25개 미만의 일괄 처리를** 목표로 하는 것이 좋습니다.
    * 저장된 일괄 처리(장면 재생 중일 때만 표시) – **정적 일괄 처리 또는 GPU 인탄싱을** 통해 감소된 그리기 호출의 양
    * SetPass 호출 – 장면에 표시되는 여러 재질의 수
    * 프레임 속도 – 게임 보기의 초당 프레임 양(발생하는 일에 대한 대략적인 아이디어를 제공합니다. fps 읽기 아웃이 편집기의 내용과 항상 다르기 때문에 Oculus Framerate 패널을 사용하여 항상 앱 내 헤드셋에서 장면을 테스트해야 합니다.)

* **프레임** 디버거(창/분석/프레임 디버거에서 찾을 수 있습니다.)  사용하도록 설정하면 GPU가 그리는 내용을 보고 최종 이미지를 만들 수 있는 통계 패널에서 첫 번째부터 마지막까지의 그리기 호출 목록을 표시합니다.  이는 그리기 호출이 이전 그리기 호출로 일괄 처리되지 않은 이유(즉, '이 개체는 다른 재질을 사용함' 또는 '이 개체는 다른 Lightmap을 사용함')에 대한 이유를 제공하며, 장면에서 발생하는 내용과 특정 시각적 선택 항목이 계산 비용이 많이 드는 방법과 이유를 모두 이해하는 데 좋은 방법입니다.

* **프로파일러에서는** 게임을 실행하는 동안 언제든 컴퓨터의 어떤 부분이 사용되는지 보여 줄 것입니다. 성능이 병목 상태가 되는 위치를 결정하는 데 유용합니다.  예를 들어 장면에서 CPU 사용량이 많은 경우 그리기 호출이 너무 많거나 GPU 사용량이 많은 경우 너무 많은 오버드로가 발생할 수 있습니다(즉, 단일 픽셀이 렌더링되어 최종 이미지를 생성하는 횟수).  또는 개체가 뷰 외부에 있을 때 제거되지 않습니다.

## <a name="draw-calls-shadersmaterialsobjects"></a>**그리기 호출(셰이더/재질/개체)**

* 셰이더, 재질 또는 개체를 렌더링해야 할 때마다 CPU는 스위치의 GPU에 지시해야 합니다('그리기 호출'이라고도 하며, **'drawcalls'라고도** 함).  즉, 셰이더 5개, 재질 10개, 개체 20개 중 가장 큰 개체가 있는 경우 약 20개의 drawcall이 있습니다.  그리기 호출을 곱할 수 있는 다른 사항으로는 여러 lightmaps에 개체가 있거나 장면에 두 개 이상의 실시간 조명이 있는 경우(즉, 한 점 광원은 해당 범위 내에 있는 모든 개체에 또 다른 그리콜을 추가함) 일반적으로 장면의 방향성 광원 이외의 다른 모든 것을 피해야 합니다.  또한 리플렉션 프로브와 광원 프로브는 적중되는 개체에 대한 호출을 곱하므로 피해야 합니다.

* **정적 일괄 처리는** GPU로 전송될 때 같은 재질을 공유하는 개체를 단일 개체로 일괄 처리하므로(폐색 선별에서 보이지 않는 메시를 삭제함) 위 예제의 모든 개체를 'Static'으로 설정하면 장면을 모든 재질에 대해 약 10개의 드로콜(1개)으로 줄일 수 있습니다. 

* **재질 일괄 처리는** 개체에 다른 개체와 같은 정확한 재질이 있는 경우 발생합니다. 그러나 개체에 재질이 여러 개 있는 경우에는 재질이 적은 개체로 일괄 처리되지 않습니다.  이러한 이유로 **개체에는 재질이 1개만 있어야** 하며, 여러 재질을 사용하는 개체는 재질당 별도의 개체로 분할되어야 합니다.  **질감 아틀래싱을** 통해 **재질 일괄 처리를** 줄일 수 있습니다(여러 고유 개체의 질감을 결합하여 단일 질감 시트를 공유하므로 모두 동일한 재질을 사용함).  가능하면 Atlases 양을 장면당 단일 2k 또는 4k 질감/재질로 유지합니다.

## <a name="scene-complexity"></a>**장면 복잡성**

* **기하 도형** – 100k 미만의 환경에 대한 화면 삼각형을 유지합니다.  Unity 게임 패널의 '통계' 탭을 사용하여 장면의 다양한 분석 지점에서 적중하는 삼각형 수를 확인합니다.  이와 같은 Props는 삼각형 범위의 '수백'에 있어야 하며, 수천 개의 삼각형 범위에서 중요한 'hero' props만 있어야 합니다. 

* UNITY의 기본 Lightmap 솔루션은 LOD 간에 Lightmap 데이터를 공유하지 않지만 **LOD(세부** 정보 메시 수준)를 기술적으로 사용할 수 있으므로 이 해상도에서 LOD가 전환되면 Lightmapping 아티팩트도 얻을 수 있습니다.  또는 개체에 낮은 LOD 메시가 없더라도 단순 거리 구형에 LOD 그룹 구성 요소를 사용할 수 있습니다.

![Unity의 LOD 그룹 창](images/world-building-lod-Group.png)

* **폐색 스컬링(Occlusion Culling)은** 카메라의 보기 frustum 내에 있는 개체로만 렌더링되고 즉시 표시되는 개체(즉, 보기에서 폐색된 개체)의 수를 줄입니다.  폐색 선별은 장면에 대해 거의 항상 베이킹되어야 하며, 수준은 이를 지원하도록 디자인되어야 합니다. 즉, 높은 수준의 벽 또는 큰 개체를 사용하여 플레이어의 시야를 분리할 수 있으므로 항상 수준의 반대쪽 끝까지 볼 수 없습니다.  '가장 작은 폐색' 또는 '가장 작은 구멍' 값을 축소해야 할 수도 있지만 기본 베이킹 설정이 작동합니다.  개체의 크래킹이나 투명한 개체를 통해 볼 수 있는 펜스와 같은 개체의 경우 '정적' 드롭다운 메뉴에서 개체의 '폐색' 상태를 해제하여 그 뒤의 개체가 잘못 가려지지 않도록 해야 합니다. 

## <a name="lightmaps"></a>**Lightmaps**

* 장면당 **하나의 lightmap(모든** 것에 대해 하나의 2k 또는 4k)만 이상적으로 표시합니다( 그렇지 않은 경우). 낮은 해상도의 많은 lightmaps보다 더 높은 해상도의 더 적은 lightmaps가 더 낫습니다.
* 여러 lightmaps가 있으면 그리기 호출 수에도 영향을 줄 수 있습니다. lightmaps가 있거나 없는 개체는 서로 다른 일괄 처리에 있고 다른 lightmaps도 서로 다른 일괄 처리에 있기 때문에 영향을 줄 수 있습니다.
* 일반적으로 단위당 약 **25텍셀의** Lightmap 해상도로 충분해야 합니다(조명/장면 설정에서 해상도 설정).  Lightmap에 추가 공간이 있는 경우 이 값을 늘릴 수 있습니다.
* 개체당 **Lightmap 크기 조정** 설정을 변경하여 필요한 개체에 대한 해상도를 저장합니다. 

* **Lightmap 배율 차트(엄지** 손가락 규칙) 
    * **전경(트래버스** 가능한 수준 지역): 1 
    * **Props(특히** 사람보다 작은 속성): **2-3(개체에** 대한 lightmap 아티팩트 및 이음매 방지) 
    * **중간(이동** 가능한 영역 및/또는 건물과 같은 큰 개체 바로 외부에 있는 기하 도형): **0.5**
    *  배경(Vista/원격 개체): **0.02** 
    * **투명** 표면(예: 투명 표면): 0('캐스트/수신 그림자'를 사용하지 않도록 설정)  

또한 기준선으로 Screen Door Effect 환경에 사용된 몇 가지 설정은 다음과 같습니다.

![Unity의 조명 창](images/world-building-lightmaps.png)

참고: 이러한 설정을 사용하는 경우 Lightmapper를 'GPU Lightmapper'로 설정하고 훨씬 더 빠른 미리 보기 준비에 대해 Lightmap 크기를 '2048'로 설정한 다음, 최종 베이킹을 위해 CPU 및 4k로 백업할 수 있습니다.

## <a name="texture-compressionfile-size"></a>**질감 압축/파일 크기**

* Android 빌드의 경우 Unity 패키지 장면 크기를 총 약 10-20MB로 낮추려고 합니다.  이렇게 하려면 여러 개체에서 제네릭 재질을 공유하고, 꼭짓점 색을 사용하여 개체를 채점하고, 질감이 기본 압축보다 작은 **ASTC 6x6 블록 압축을** 사용하도록 Android에 대한 수동 재정의를 설정하여 수행합니다.

* ASTC를 사용하도록 Android 빌드 설정을 설정하지 않은 이유는 lightmaps가 해당 압축(많은 차단 아티팩트)과 잘 보이지 않기 때문에 준비할 때마다 ETC를 사용하도록 Lightmap을 설정해야 하기 때문입니다. 따라서 준비할 때마다 Lightmap의 압축 설정을 업데이트하는 것보다 모든 장면 질감에 대한 재정의를 한 번 설정하는 것이 더 쉽습니다.

![Unity의 질감 창](images/world-building-texutres.png)

* 또한 2 이방성 수준으로 3선형 필터 모드를 사용하도록 질감을 설정하면 선형 각도를 선명하게 유지하는 데 도움이 될 수 있습니다.

더 많은 성능 팁과 요령은 [세계 성능 향상 설명서](improving-performance.md)에서 찾을 수 있습니다.
